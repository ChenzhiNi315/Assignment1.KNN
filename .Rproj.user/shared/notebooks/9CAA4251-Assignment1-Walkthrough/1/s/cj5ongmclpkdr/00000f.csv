"0","# 1. Extract the confusion matrix from the 'final_evaluation' list"
"0","#    (this variable was created in the 'task5' chunk)"
"0","my_matrix <- final_evaluation$confusion_matrix"
"0",""
"0","# 2. Convert the 'table' object into a data frame for ggplot"
"0","#    The data frame will have three columns: Actual, Predicted, Freq (Frequency)"
"0","cm_df <- as.data.frame(my_matrix)"
"0",""
"0","# 3. Create the heatmap using ggplot2"
"0","heatmap_plot <- ggplot(data = cm_df, aes(x = Predicted, y = Actual, fill = Freq)) +"
"0","  "
"0","  # Draw the tiles (the squares)"
"0","  geom_tile(color = ""black"") + # Add a black border between squares"
"0","  "
"0","  # Add the number (Freq) to each square"
"0","  # We set a threshold: if Freq=0, don't print the number"
"0","  geom_text(aes(label = ifelse(Freq == 0, """", Freq)), "
"0","            color = ""black"", size = 4) +"
"0","  "
"0","  # Set the color scheme:"
"0","  # 0 (low) = white, high = deep blue"
"0","  scale_fill_gradient(low = ""white"", high = ""steelblue"", name = ""Count"") +"
"0","  "
"0",""
"0","# y-axis for factors, so '0' is at the top."
"0","scale_y_discrete(limits = rev) +"
"0","  # --- 【【【【【 END MODIFICATION 】】】】】 ---"
"0","  "
"0","  # Add clear labels"
"0","  labs("
"0","    title = ""Confusion Matrix Heatmap"","
"0","    subtitle = ""Actual vs. Predicted Digits (Test Set)"","
"0","    x = ""Predicted Digit"","
"0","    y = ""Actual Digit"""
"0","  ) +"
"0","  "
"0","  # Use a clean theme and adjust fonts"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 20, face = ""bold"", hjust = 0.5), # Center"
"0","    plot.subtitle = element_text(size = 14, hjust = 0.5), # Center"
"0","    axis.title = element_text(size = 14),"
"0","    axis.text = element_text(size = 12, face = ""bold""),"
"0","    legend.position = ""right"""
"0","  )"
"0",""
"0","# 4. Print the heatmap"
"0","print(heatmap_plot)"
