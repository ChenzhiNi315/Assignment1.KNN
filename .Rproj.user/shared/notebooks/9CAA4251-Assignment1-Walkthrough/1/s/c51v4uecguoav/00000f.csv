"0","# 1. Get the variables we need from previous chunks"
"0","best_k <- k_search$best_k"
"0","train_data <- datasets$train_data"
"0","valid_data <- datasets$valid_data"
"0",""
"0","# --- 2. Create the TRAINING confusion matrix ---"
"0","fit_train_bestk <- kknn::kknn(Digit ~ ., train_data, train_data, k = best_k, kernel = ""rectangular"")"
"0","pred_train_bestk <- stats::fitted(fit_train_bestk)"
"0","cm_train <- table(Actual = train_data$Digit, Predicted = pred_train_bestk)"
"0",""
"0","# --- 3. Create the VALIDATION confusion matrix ---"
"0","fit_valid_bestk <- kknn::kknn(Digit ~ ., train_data, valid_data, k = best_k, kernel = ""rectangular"")"
"0","pred_valid_bestk <- stats::fitted(fit_valid_bestk)"
"0","cm_valid <- table(Actual = valid_data$Digit, Predicted = pred_valid_bestk)"
"0",""
"0","# --- 4. Plot Heatmap for TRAINING data ---"
"0","# (This calls the new function from your package)"
"0","print(plot_confusion_matrix(cm_train, title = ""Training Set""))"
